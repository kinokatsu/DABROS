var timerchk,compFlg,counter,frame,wsize,genbaState;function GWt(){$("#lnkBtn_submit").hide();$("#preloadimg").show();startOpe("RqGWt:0");counter=8}function CRO(){showframe("\u73fe\u5834\u306e\u8a2d\u5b9a\u3092\u53d6\u5f97\u4e2d\u30fb\u30fb");$("#preloadimg1st").show();startOpe("RqCRo:0");counter=8}function CWO(){var a;a=$("#OnOff").val();if(genbaState.substr(5)==a){jAlert("\u73fe\u5834\u306e\u8a2d\u5b9a\u3068\u540c\u3058\u305f\u3081\u3001\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3044\u307e\u305b\u3093\u3002","\u8a2d\u5b9a\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u305b\u3093");return false}if(a==-1){jAlert("\u81ea\u52d5\u53ce\u9332\u3059\u308b\uff0f\u3057\u306a\u3044\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002","\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044");return false}$("#lnkBtn_submit").hide();$("#preloadimg").show();startOpe("RqCWo:"+a);counter=8}function SWa(){$("#lnkBtn_submit").hide();$("#preloadimg").show();startOpe("RqSWa:0");counter=8}function CYR(){showframe("\u73fe\u5834\u306e\u8a2d\u5b9a\u3092\u53d6\u5f97\u4e2d\u30fb\u30fb");$("#preloadimg1st").show();startOpe("RqCYR:0");counter=8}function CYW(){var f,b=$("#stDate").val(),c=$("#edDate").val(),d=$("#interval").val(),a;if(b.length<12){alert("\u300c\u53ce\u9332\u958b\u59cb\u6642\u523b\u300d\u306e\u6587\u5b57\u6570\u304c\u8db3\u308a\u3066\u3044\u307e\u305b\u3093\u3002");$("#stDate").focus();return false}if(checkDate(b)==false){$("#stDate").focus();alert("\u300c\u53ce\u9332\u958b\u59cb\u6642\u523b\u300d\u306e\u5f62\u5f0f\u304c\u9593\u9055\u3048\u3066\u3044\u307e\u3059\u3002");return false}checkDate(c)==false&&$("#edDate").val("999999999999");var e=isRange(d,5,99999);if(e==1){alert("\u300c\u53ce\u9332\u9593\u9694\u300d\u306e\u8a2d\u5b9a\u304c\u9593\u9055\u3048\u3066\u3044\u307e\u3059\u3002[5\uff5e99999]\u307e\u3067\u306e\u9593\u3067\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002");$("#interval").focus();return false}a=b+","+c+","+d;if(genbaState.substr(5)==a){jAlert("\u73fe\u5834\u306e\u8a2d\u5b9a\u3068\u540c\u3058\u305f\u3081\u3001\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3044\u307e\u305b\u3093\u3002","\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u305b\u3093");return false}$("#lnkBtn_submit").hide();$("#preloadimg").show();startOpe("RqCYW:"+a);counter=8}function checkDate(a){var f=a.substr(0,4),d=a.substr(4,2),b=a.substr(6,2),c=a.substr(8,2),e=a.substr(10,2);dt=new Date(f,d-1,b,c,e,"00");return dt.getFullYear()==f&&dt.getMonth()==d-1&&dt.getDate()==b&&dt.getHours()==c&&dt.getMinutes()==e}function PRt(){showframe("\u73fe\u5834\u306e\u8a2d\u5b9a\u3092\u53d6\u5f97\u4e2d\u30fb\u30fb");$("#preloadimg1st").show();startOpe("RqPRt:1");counter=8}function PWt(){window.scrollTo(0,300);var a,b,c;b=getCheckState(0);if(typeof b[0]==="undefined"){jAlert("\u6642\u523b\u304c\uff11\u3064\u3082\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002","\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044");return false}a=getCheckState(1);if(typeof a[0]==="undefined"){jAlert("\u5206\u304c\uff11\u3064\u3082\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002","\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044");return false}if(a[1]>12)if(!window.confirm("\u6e2c\u5b9a\u9593\u9694\u30925\u5206\u4ee5\u4e0b\u306b\u3059\u308b\u3068\u3001\u30c7\u30fc\u30bf\u3092\u53ce\u9332\u51fa\u6765\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u8a2d\u5b9a\u3057\u307e\u3059\u304b\uff1f"))return false;c=b[0]+a[0];if(genbaState.substr(5)==c){jAlert("\u73fe\u5834\u306e\u8a2d\u5b9a\u3068\u540c\u3058\u305f\u3081\u3001\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3044\u307e\u305b\u3093\u3002","\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u305b\u3093");return false}$("#lnkBtn_submit").hide();$("#preloadimg").show();startOpe("RqPWt:"+c);counter=8}function startOpe(a){$("#order").html("");$("#resSite").text("");compFlg=0;CommandSend(a);timerchk=setTimeout(function(){CommandReceive()},5e3)}function CommandReceive(){Control.SitePC.ControlFile.Confirm("0",onComplete,onError,"#resSite")}function CommandSend(a){Control.SitePC.ControlFile.Add(a,onComplete,onError,"#order")}function onComplete(d,b){b=="#order"&&$("#resSite").text("\u73fe\u5834\u304b\u3089\u306e\u5fdc\u7b54\u3092\u8a18\u8f09\u3057\u307e\u3059["+counter+"]");d.indexOf("RCVNG")!=-1&&$("#resSite").text("");var a,f;if(b!="#order"&&d.indexOf("No")==-1)f="["+counter+"]";else f="";a=d.replace("[RCVNG]","");a=a.replace("[RCV]","");if(a.indexOf("|")!=-1){var c;c=a.split("|");genbaState=c[1];if(a.indexOf("PRt")!=-1){var g,h;g=c[1].substr(5,24);h=c[1].substr(29,60);setCheck(0,g);setCheck(1,h)}else if(a.indexOf("CYR")!=-1){var e=c[1].substr(5).split(",");$("#stDate").val(e[0]);$("#edDate").val(e[1]);$("#interval").val(e[2])}else if(a.indexOf("CRo")!=-1||a.indexOf("CWo")!=-1){var i,k="\u81ea\u52d5\u53ce\u9332\uff1a\u3059\u308b",j="#d2d2ff";i=c[1].substr(5,1);if(i=="0"){k="\u81ea\u52d5\u53ce\u9332\uff1a\u3057\u306a\u3044";j="#ffa2a2"}$("#status").text(k);$("#status").css("background-color",j)}$(b).html(c[0])}else $(b).html(a);if(d.indexOf("RCV")!=-1){compFlg=1;$("#preloadimg").hide();$("#blockframe")[0]&&frame.parentNode.removeChild(frame);$("#preloadimg1st").hide();clearTimeout(timerchk);d.indexOf("\u6b63\u5e38")==-1&&$("#lnkBtn_submit").show()}else if(counter==0){$("#preloadimg").hide();frame.parentNode.removeChild(frame);$("#preloadimg1st").hide();$(b).html("\u73fe\u5834\u304b\u3089\u5fdc\u7b54\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f");$("#lnkBtn_submit").show()}else if(b!="#order")timerchk=setTimeout("CommandReceive();",15000);if(b!="#order")counter--}function onError(a){alert(a.get_message());if(counter!=0||compFlg!=1)timerchk=setTimeout("CommandReceive();",1e4)}$(function(){$("div.checkbox-group input").each(function(){this.checked==true&&$(this).next().addClass("checked")});$("div.checkbox-group label").click(function(){if($(this).hasClass("checked"))$(this).removeClass("checked").prev("input").attr("checked",true);else $(this).addClass("checked").prev("input").attr("checked",false)})});function getCheckState(d){var a="",b=0,e;if(d==0)var c=$("#chbHour input");else var c=$("#chbMin input");for(i=0;i<c.length;i++)if(c[i].checked){a=a+"1";i+",";b++}else a=a+"0";if(b==0)a=undefined;return[a,b]}function stringRepaet(d,b,c){var a="";for(i=0;i<=c;i++)a+=b;return a}function setCheck(f,a){var e,b=0,c=0;if(f==0){var d=$("#chbHour input");c=23}else{var d=$("#chbMin input");c=59}e=String(a);if(e.length==1)a=stringRepaet(f,a,c);for(i=0;i<a.length;i++){b=parseInt(a.charAt(i));d[i].checked=Boolean(b);if(b==0)$(d[i]).next().removeClass("checked");else $(d[i]).next().addClass("checked")}}function setInterval(f){var d,b,c,a=0,e=0;if(f==0){d=parseInt($("#stHour").val());b=parseInt($("#intervH").val());e=parseInt(23);c=$("#chbHour input")}else{d=parseInt($("#stMin").val());b=parseInt($("#intervM").val());e=parseInt(59);c=$("#chbMin input")}a=isNumeric(d);a+=isNumeric(b);if(a){jAlert("\u672a\u5165\u529b\u3001\u3082\u3057\u304f\u306f\u6570\u5b57\u4ee5\u5916\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002","\u5165\u529b\u5024\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044");return false}a=0;a=isRange(d,0,e);a+=isRange(b,1,e);if(a){jAlert("\u7bc4\u56f2\u5916\u306e\u6570\u5b57\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u3059(\u30de\u30a4\u30ca\u30b9\u306e\u6570\u5024\u306a\u3069)\u3002\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002","\u5165\u529b\u5024\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044");return false}setCheck(f,0);for(i=d;i<c.length;i+=b){c[i].checked=true;$(c[i]).next().addClass("checked")}}function isNumeric(b){var a=0;if(isFinite(b)==false)a=1;return a}function isRange(a,d,c){var b=0;if(a>c||a<d)b=1;return b}function showframe(e){var f;getsize=function(a){return{dwidth:a.clientWidth,dheight:a.clientHeight,width:a.scrollWidth,height:a.scrollHeight}};wsize=getsize(document.documentElement);frame=document.body.appendChild(document.createElement("div"));if(frame.style.setExpression)frame.style.position="absolute";else frame.style.position="fixed";frame.className="blockframe";frame.id="frameArea";frame.style.left="0px";frame.style.top="0px";frame.style.width=wsize.dwidth+"px";frame.style.height=wsize.dheight+200+"px";frame.style.filter="alpha(opacity=50)";var a=document.createElement("div");frame.appendChild(a);a.id="blockframe";a.className="innerframe";a.style.position="fixed";a.style.left="0px";a.style.top="0px";a.style.width=wsize.dwidth+"px";a.style.height=wsize.dheight+"px";a.style.filter="alpha(opacity=60)";var b=document.createElement("img");b.id="aniload2nd";b.src="img/loader4.gif";a.appendChild(b);var c=document.createElement("span"),d=document.createTextNode(e);c.appendChild(d);a.appendChild(c)}$(window).resize(function(){var a=getsize(document.documentElement);frame.style.width=a.dwidth+"px";frame.style.height=a.dheight+200+"px";if($("#blockframe")[0]){$("#blockframe").width(a.dwidth);$("#blockframe").height(a.dheight+200)}});function ime(){$(".numeric").numeric();$(".integer").numeric({decimal:false});$(".positive").numeric({negative:false});$(".positive-integer").numeric({decimal:false,negative:false});$(".antirc").change(function(){$(this).keyup()});$(".antirc").change(function(){$(this).keyup()})}