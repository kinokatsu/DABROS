var chart1,chart2,chart3,loaded,opeTime;function pageLoad(){test()}function canvas_resize(){this.window.resizeTo(757,800)}function PrintPreview(){window.print()}function CheckBrowserReadyState(){return window.document.readyState!==null&&window.document.readyState!="complete"?false:true}function CheckRegExp(){var a="",b=new RegExp("^[+-]?[0-9]{1,6}.?[0-9]{0,2}$");for(i=1;i<=6;i++)if(document.getElementById(["TxtMax"+i])!==undefined){a=document.getElementById(["TxtMax"+i]).value;if(!a.match("^[+-]?[0-9]{1,6}.?[0-9]{0,2}$")){showAlert("\u5165\u529b\u30a8\u30e9\u30fc","\u3010\u6700\u5927\u5024 No."+i+"\u3011\u306b\u5165\u529b\u306b\u9593\u9055\u3044\u304c\u3042\u308a\u307e\u3059\u3002\u3000\u6570\u5024(\u534a\u89d2)\u306e\u307f\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002");CancelPostBack()}}}function CancelPostBack(){var a=Sys.WebForms.PageRequestManager.getInstance();a.abortPostBack()}function getMaxMin(){var d,b,c;d=$("input[name='No1']:checked").val();if(d=="RdbNo11"){var a;a=$("#DdlScale1").val();if(a==9999){b=null;c=null}else{b=a;c=-a}}else{b=$("#TxtMax1").val();c=$("#TxtMin1").val()}return[b,c]}function setScale(){var a=getMaxMin();chart1.axisY[0].set("maximum",a[0]);chart1.axisY[0].set("minimum",a[1]);chart2.axisY[0].set("maximum",a[0]);chart2.axisY[0].set("minimum",a[1]);chart3.axisY[0].set("maximum",a[0]);chart3.axisY[0].set("minimum",a[1]);$(".canvasjs-chart-toolbar").css("display","none")}function getDate(){var d=$("#DDLYMon").val(),c=$("#DDLDay").val(),a=$("#DDLHMin").val(),b=-1;if(a!==""&&c!==""&&a!==""){b=d.replace("\u5e74 ","").replace("\u6708","")+c.replace("\u65e5","_");b+=a.replace(/:/g,"");return[b,d+" "+c+" "+a]}else{showAlert("\u65e5\u4ed8\u9078\u629e\u30a8\u30e9\u30fc","\u65e5\u4ed8\u3051\u6307\u5b9a\u3092\u898b\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");return[-1,-1]}}function showAlert(b,a){$.alert({title:b,content:a,closeIcon:true,animation:"zoom",closeAnimation:"zoom",boxWidth:"300px",useBootstrap:false,type:"red",bgOpacity:.7,buttons:{okay:{text:"OK",btnClass:"btn-primary"}}})}function downloadCSV(h){var c,j,e="",a="",b="",f,g;c=$("#DDLSensor").val();csv=getDate();if(csv[0]==-1)return false;buttonEnable("true");if(h=="p"){$("#csv_part").addClass("bpic");param={dt:csv[0],sn:c};e="./api/datarq_wv.ashx";a=csv[0]+"_"+c+".csv";var i=c.replace("No.","");b=csv[1]+","+c+"\ntime,";b+="N@-X,N@-Y,N@-Z".replace(/@/g,i)+"\n";b+="sec,kine,kine,kine\n";f="shift-jis";g="json"}else{$("#csv_all").addClass("bpic");param={dt:csv[0]};e="./api/datarq_wv_all.ashx";a=csv[0]+".csv";b="";f="shift-jis";g="text"}var d="";d=b;$.ajax({type:"GET",dataType:g,scriptCharset:f,data:param,url:e,cache:false,timeout:15000}).done(function(f){if(h=="p")$.each(f,function(b,a){d+=a[0]+","+a[1]+","+a[2]+","+a[3]+"\n"});else d=f;delayEnable(0);var i=new Uint8Array([239,187,191]),b=new Blob([i,d],{type:"text/csv"});if(window.navigator.msSaveBlob){window.navigator.msSaveBlob(b,a);window.navigator.msSaveOrOpenBlob(b,a)}else{var g=window.navigator.userAgent.toLowerCase(),l=window.navigator.appVersion.toLowerCase(),k=navigator.userAgent.toLowerCase(),j=window.URL,e=j.createObjectURL(b);if(g.indexOf("firefox")!=-1||k.indexOf("opera")!=-1){document.getElementById("download").download=a;document.getElementById("download").href=e;document.getElementById("download").click()}else{var c=document.createElement("a");c.download=a;c.href=e;c.click()}}}).fail(function(){showAlert("\u30c7\u30fc\u30bf\u8aad\u8fbc\u7570\u5e38\u767a\u751f","\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u521d\u671f\u72b6\u614b\u306b\u623b\u3057\u307e\u3059\u3002");$("#ImbtnReloadGraph").click()});$("#csv_part").removeClass("bpic");$("#csv_all").removeClass("bpic");makecsv=void 0}function buttonEnable(a){$("#csv_part").prop("disabled",a);$("#csv_all").prop("disabled",a);$("#drawGraph").prop("disabled",a)}function getWaveData(){var c;c=$("#DDLSensor").val();showDate=getDate();if(showDate[0]==-1)return;buttonEnable(true);$("#csv_part").val(c+"\u306e\u307f");var a=getMaxMin(),b=[],d=[],e=[];$.ajax({type:"GET",dataType:"json",scriptCharset:"shift-jis",data:{dt:showDate[0],sn:c},url:"./datarq_wv.ashx",cache:false,timeout:1e4}).done(function(f){$.each(f,function(c,a){b.push({x:a[0],y:a[1]});d.push({x:a[0],y:a[2]});e.push({x:a[0],y:a[3]})});delayEnable(0);chart1=new CanvasJS.Chart("cCtnr1",{zoomEnabled:true,zoomType:"xy",theme:"theme1",animationEnabled:true,animationDuration:400,axisY2:{includeZero:false,lineThickness:2},axisX:{interval:5,minimum:0,maximum:60,labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisX2:{lineThickness:2},axisY:{titleFontSize:16,minimum:a[1],maximum:a[0],title:"\uff38\u6210\u5206 \u901f\u5ea6(kine)",titleFontFamily:"meiryo",labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisY2:{includeZero:false,lineThickness:2},toolTip:{fontSize:13,borderColor:"black",content:"\u7d4c\u904e\u6642\u9593: {x}(sec)</br>\u901f\u3000\u3000\u5ea6: {y}(kine)",fontStyle:"italic",fontFamily:"meiryo",backgroundColor:"rgba(240,240,240,.8)"},data:[{type:"line",dataPoints:b},{type:"line",axisYType:"secondary"},{type:"line",axisXType:"secondary"}],rangeChanged:syncHandler});chart1.render();chart2=new CanvasJS.Chart("cCtnr2",{zoomEnabled:true,zoomType:"xy",animationEnabled:true,animationDuration:350,axisY2:{includeZero:false,lineThickness:2},axisX:{interval:5,minimum:0,maximum:60,labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisX2:{lineThickness:2},axisY:{titleFontSize:16,minimum:a[1],maximum:a[0],title:"\uff39\u6210\u5206 \u901f\u5ea6(kine)",titleFontFamily:"meiryo",labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisY2:{includeZero:false,lineThickness:2},toolTip:{fontSize:13,borderColor:"black",content:"\u7d4c\u904e\u6642\u9593: {x}(sec)</br>\u901f\u3000\u3000\u5ea6: {y}(kine)",fontStyle:"italic",fontFamily:"meiryo",backgroundColor:"rgba(240,240,240,.8)"},data:[{type:"line",dataPoints:d},{type:"line",axisYType:"secondary"},{type:"line",axisXType:"secondary"}],rangeChanged:syncHandler});chart2.render();chart3=new CanvasJS.Chart("cCtnr3",{zoomEnabled:true,zoomType:"xy",animationEnabled:true,animationDuration:300,axisY2:{includeZero:false,lineThickness:2},axisX:{interval:5,minimum:0,maximum:60,labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisX2:{lineThickness:2},axisY:{titleFontSize:16,minimum:a[1],maximum:a[0],title:"\uff3a\u6210\u5206 \u901f\u5ea6(kine)",titleFontFamily:"meiryo",labelFontSize:16,gridDashType:"shortDot",gridThickness:1},axisY2:{includeZero:false,lineThickness:2},toolTip:{fontSize:13,borderColor:"black",content:"\u7d4c\u904e\u6642\u9593: {x}(sec)</br>\u901f\u3000\u3000\u5ea6: {y}(kine)",fontStyle:"italic",fontFamily:"meiryo",backgroundColor:"rgba(240,240,240,.8)"},data:[{type:"line",dataPoints:e},{type:"line",axisYType:"secondary"},{type:"line",axisXType:"secondary"}],rangeChanged:syncHandler});chart3.render();$("#LblTitleLower").text("\u3010"+c+" \u6e2c\u70b9 \u632f\u52d5\u6ce2\u5f62\u30c7\u30fc\u30bf\u3011");$("#LblDateSpan").text("\u30c7\u30fc\u30bf\u65e5\u6642\uff1a"+showDate[1]);$(".pic").off("click");setPicDL()}).fail(function(){showAlert("\u30c7\u30fc\u30bf\u8aad\u8fbc\u7570\u5e38\u767a\u751f","\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u521d\u671f\u72b6\u614b\u306b\u623b\u3057\u307e\u3059\u3002");$("#ImbtnReloadGraph").click()});b.length=0;d.length=0;b.length=0}function delayEnable(a){setTimeout(function(a){buttonEnable(a)},700+a,false)}function setPicDL(){$(".pic").on("click",function(){var b=getDate(),c=$(this).data("dir");if(b[0]==-1)return;var e=$("#DDLSensor").val(),a,d;switch(c){case"_X":a=chart1;break;case"_Y":a=chart2;break;case"_Z":a=chart3}d=b[0]+c+"_"+e;a.exportChart({format:"png",fileName:d})})}var charts0=[chart1,chart2,chart3];function syncHandler(a){for(var b=0;b<charts0.length;b++){eval("var chart=chart"+(b+1)+";");if(!chart.options.axisX)chart.options.axisX={};if(!chart.options.axisY)chart.options.axisY={};if(a.trigger==="reset"){chart.options.axisX.viewportMinimum=chart.options.axisX.viewportMaximum=null;chart.options.axisY.viewportMinimum=chart.options.axisY.viewportMaximum=null;chart.render()}else if(chart!==a.chart){chart.options.axisX.viewportMinimum=a.axisX[0].viewportMinimum;chart.options.axisX.viewportMaximum=a.axisX[0].viewportMaximum;chart.options.axisY.viewportMinimum=a.axisY[0].viewportMinimum;chart.options.axisY.viewportMaximum=a.axisY[0].viewportMaximum;chart.render()}}}function test(){var a=[];a.push({value:16,thickness:3,showOnTop:true,color:"rgba(234,234,0,1)",labelAlign:"far",label:"Alert Level 1",labelFontColor:"rgba(0,0,0,0.3)"});a.push({value:18,thickness:3,showOnTop:true,color:"rgba(255,128,128,1)",labelAlign:"far",label:"Alert Level 2",labelFontColor:"rgba(0,0,0,0.3)"});a.push({value:20,thickness:3,showOnTop:true,color:"rgba(255,0,0,1)",labelAlign:"far",label:"Alert Level 3",labelFontColor:"rgba(0,0,0,0.3)"});a.push({value:22,thickness:3,showOnTop:true,color:"rgba(255,0,255,1)",labelAlign:"far",label:"Alert Level 4",labelFontColor:"rgba(0,0,0,0.3)"});var b=new CanvasJS.Chart("chartContainer",{animationEnabled:true,animationDuration:500,zoomEnabled:false,toolTip:{enabled:false},axisX:{valueFormatString:"",minimum:0,maximum:10,interval:0,labelFontSize:0,tickThickness:0,lineThickness:0},axisX2:{lineThickness:0},axisY:{margin:10,title:"",titleFontSize:18,minimum:0,maximum:25,interval:5,gridThickness:0,stripLines:a,includeZero:true,gridDashType:"shortDot",labelFormatter:function(){return" "},titleFontFamily:"meiryo",lineThickness:0,tickLength:0},axisY2:{includeZero:false,lineThickness:0,tickLength:0,labelFormatter:function(){return" "},minimum:0,maximum:25,interval:5,gridThickness:0},data:[{name:"dummy",type:"line",showInLegend:false,dataPoints:[],axisYType:"secondary",axisXType:"secondary"},{name:"Water Head",showInLegend:false,type:"area",color:"rgba(119,187,255,0.7)",markerType:"none",markerSize:0,titleFontFamily:"meiryo",toolTipContent:function(){return" "},dataPoints:[{x:0,y:12.8},{x:5,y:12.8,indexLabelFormatter:function(a){return"\u6c34\u4f4d :"+a.dataPoint.y+"(m)"}},{x:10,y:12.8}]},{name:"River Shape",markerType:"none",showInLegend:false,legendMarkerType:"none",type:"area",color:"rgba(207,187,139,1)",markerSize:0,fillOpacity:1,toolTipContent:function(){return" "},dataPoints:[{x:0,y:22},{x:1,y:22},{x:2.5,y:5},{x:7.5,y:5},{x:9,y:22},{x:10,y:22}]},{name:"River Shape Line",markerType:"none",showInLegend:false,legendMarkerType:"none",type:"line",color:"rgba(177,147,73,1)",markerSize:0,fillOpacity:1,toolTipContent:function(){return" "},dataPoints:[{x:0,y:22},{x:1,y:22},{x:2.5,y:5},{x:7.5,y:5},{x:9,y:22},{x:10,y:22}]}]});b.render();window.matchMedia("print").addListener();b.render()}