var svrdt,svrno,checkInterval,timer1,targetBtnMainObj,targetBtnReloadObj,targetInpObj1,targetInpObj2,ptyp,baseInt=59000,longInt=181000,NCInt=1.5e6;$(document).ready(function(){setObject();console.log(document.URL);console.log("Load - "+formatDate(new Date,"yyyy/MM/dd HH:mm:ss"));if(typeof window.console==="undefined")window.console={};if(typeof window.console.log!=="function")window.console.log=function(){};if(typeof window.console.log!=="function")window.console.log=function(){}});function setObject(){var a=document.URL;targetBtnMainObj=$("#ImbtnRedrawGraph");targetBtnReloadObj=$("#btnSubmit");targetInpObj1=$("#nwdt");targetInpObj2=$("#nwdtno");checkInterval=baseInt;if(a.includes("Graph_Time")===true)ptyp=1;else if(a.includes("Table_Time")===true){checkInterval+=2e3;ptyp=0}else if(a.includes("Graph_Depth")===true){checkInterval+=4e3;ptyp=1}else if(a.includes("Graph_Disp")===true){checkInterval+=6e3;ptyp=1}else if(a.includes("Table_Summ")===true){checkInterval+=8e3;ptyp=0}else{checkInterval=longInt;ptyp=0}svrdt=targetInpObj1.val();svrno=targetInpObj2.val();if(svrdt.includes("NC")===true)checkInterval=NCInt;timer1=setInterval(dtchk,checkInterval)}var dtchk=function(){$("#imgloader").show();svrdt=targetInpObj1.val();svrno=targetInpObj2.val();console.log("<------>");console.log("This---- "+svrdt+" -> ");console.log("window.name = "+window.name);var b=window.opener.document.getElementById("ctl00_CntplHolder_nwdt");if(b!==null){var a=b.value;console.log("GetDate_All-  -> "+a);if(a.includes("DataEr")===true){console.log("DataError - SubButton Click - "+formatDate(new Date,"yyyy/MM/ss HH:mm:ss"));clearInterval(timer1);targetBtnReloadObj.click()}else if(compareDate(a)){console.log("Update - MainButton Click - "+formatDate(new Date,"yyyy/MM/ss HH:mm:ss"));ptyp===0&&clearInterval(timer1);targetBtnMainObj.click()}}$("#imgloader").hide()};function compareDate(k){var l=0,j=0,f,e,d=svrdt.split(","),b=svrno.split(","),c=k.split(","),h=false,a;console.log("URL -- "+document.URL);for(a=0;a<d.length;a++){if(svrdt.includes("NC")===true){console.log("No check site.");console.log("-"+formatDate(new Date,"yyyy/MM/dd HH:mm:ss"));break}var g=[];g=d[a].split(" ");console.log("Loop:"+a+"  FileNo:"+b[a]+"  svrDate:"+d[a]);if(CheckDate(g[0])&&CheckTime(g[1])){f=new Date(d[a]);l=1}console.log("Loop:"+a+"  FileNo:"+b[a]+"  chkDate:"+c[b[a]]);var i=c[b[a]].split(" ");if(CheckDate(i[0])&&CheckTime(i[1])){e=new Date(c[b[a]]);j=1}if(l===1&&j===1){console.log(a+" "+checkInterval);console.log("Hidden-"+formatDate(f,"yyyy/MM/dd HH:mm:ss"));console.log("Get----"+formatDate(e,"yyyy/MM/dd HH:mm:ss"));if(f<e){h=true;if(b.length===1)targetInpObj1.val([c[b[a]]]);else{targetInpObj1.val([k]);break}}}}return h}function CheckDate(c){var a=c.split("/");if(a.length!==3)return false;var b=new Date(a[0],a[1]-1,a[2]);return a[0]!==String(b.getFullYear())||a[1]!==("0"+(b.getMonth()+1)).slice(-2)||a[2]!==("0"+b.getDate()).slice(-2)?false:true}function CheckTime(a){return a.match(/^([01]?[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/)!==null}function addMessage(e){var a=new Date,b=("0"+a.getHours().toString()).substr(-2),d=("0"+a.getMinutes().toString()).substr(-2),f=("0"+a.getSeconds().toString()).substr(-2),c=b+":"+d+":"+f,g=c+" "+e+"\n"}function formatDate(b,a){a=a.replace(/yyyy/g,b.getFullYear());a=a.replace(/MM/g,("0"+(b.getMonth()+1)).slice(-2));a=a.replace(/dd/g,("0"+b.getDate()).slice(-2));a=a.replace(/HH/g,("0"+b.getHours()).slice(-2));a=a.replace(/mm/g,("0"+b.getMinutes()).slice(-2));a=a.replace(/ss/g,("0"+b.getSeconds()).slice(-2));a=a.replace(/SSS/g,("00"+b.getMilliseconds()).slice(-3));return a}function alertDialog(c){var b={title:"",body:"",close:function(){return true}},a=$.extend(b,c,{}),d=$("<div />",{title:a.title,html:a.body});d.dialog({modal:true,close:function(){var b=$(this);b.dialog("destroy");b.remove();a.close()},buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]})}